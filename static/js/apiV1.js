(function() {
    var apiV1 = {
        kernels: function() {
            var base = '/api/v1/kernels';
            return {
                add: function(kernel) {
                    return apiFetcher('POST', base, kernel);
                }
            };
        },
        kernel: function(repo) {
            var base = '/api/v1/kernels/' + repo;
            return {
                get: function() {
                    return apiFetcher('GET', base);
                },
                edit: function(data) {
                    return apiFetcher('PATCH', base, data);
                }
            };
        },
        branch: function(repo, branch) {
            var base = '/api/v1/kernels/' + repo + '/' + branch;
            return {
                changeStatuses: function(cves, value) {
                    var endpoint = base + '/statuses';
                    return apiFetcher('POST', endpoint, {
                        cves: cves,
                        value: value
                    });
                },
                importStatuses: function(fromRepo, fromBranch, override) {
                    var endpoint = base + '/import_statuses';
                    return apiFetcher('POST', endpoint, {
                        'repo': fromRepo,
                        'branch': fromBranch,
                        'override': override
                    });
                }
            };
        },
        cves: function() {
            var base = '/api/v1/cves';
            return {
                add: function(cve) {
                    return apiFetcher('POST', base, cve);
                }
            };
        },
        cve: function(name) {
            var base = '/api/v1/cves/' + name;
            return {
                get: function() {
                    return apiFetcher('GET', base)
                }
            };
        }
    };
    window.apiV1 = apiV1;
})();