from flask import jsonify

def json_response(d, code, success=None):
    if success != None:
        d['success'] = success
    return jsonify(d), code

def json_response_success(d, code):
    return json_response(d, code, success=True)

def json_response_error(d, code):
    return json_response(d, code, success=False)

def split_filter(s, separator):
    return filter(lambda x: x != '', s.split(separator))

def repo_to_vendor_device(repo):
    def is_new_format(repo):
        return len(split_filter(repo, '_')) > 3

    def is_old_Format(repo):
        return len(split_filter(repo, '-')) > 2

    def is_empty(repo):
        return len(repo) == 0

    if is_empty(repo):
        raise ValueError('Repo name cannot be empty.')

    if is_old_Format(repo):
        parts = split_filter(repo, '-')
        v = parts[0]
        d = parts[2]
    elif is_new_format(repo):
        parts = split_filter(repo, '_')
        v = parts[2]
        d = '_'.join(parts[3:])
    else:
        raise ValueError('Repo name has an invalid format.')

    return v, d
